<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Working Productive Cloud Tester</title>
    <style>
        body { font-family: Arial, sans-serif; background: #0a0a0a; color: #fff; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: #1a1a1a; padding: 20px; border-radius: 10px; }
        .header { text-align: center; margin-bottom: 20px; }
        .instructions { background: #333; padding: 20px; border-radius: 10px; margin: 20px 0; border: 2px solid #00ff88; }
        .btn { padding: 15px 30px; margin: 10px; border: none; border-radius: 10px; font-size: 1rem; cursor: pointer; }
        .btn-open { background: #0066ff; color: #fff; }
        .btn-test { background: #00aa44; color: #fff; }
        .btn-clear { background: #666; color: #fff; }
        .test-item { display: flex; justify-content: space-between; padding: 10px; margin: 5px 0; background: #333; border-radius: 5px; }
        .result-pass { background: #0a0; color: #fff; padding: 2px 8px; border-radius: 10px; }
        .result-fail { background: #a00; color: #fff; padding: 2px 8px; border-radius: 10px; }
        .result-pending { background: #666; color: #fff; padding: 2px 8px; border-radius: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧪 Working Productive Cloud Tester</h1>
            <p>This tester actually works - no more "stuck at loading"!</p>
        </div>

        <div class="instructions">
            <h3>📋 How to Use (IMPORTANT!)</h3>
            <ol>
                <li><strong>Step 1:</strong> Click "🚀 Open Productive Cloud" button below</li>
                <li><strong>Step 2:</strong> Wait for your app to fully load (see calendar)</li>
                <li><strong>Step 3:</strong> Come back here and click "🧪 Run Tests"</li>
                <li><strong>Step 4:</strong> Watch real test results appear!</li>
            </ol>
        </div>

        <div style="text-align: center;">
            <button class="btn btn-open" onclick="openApp()">🚀 Open Productive Cloud</button>
            <button class="btn btn-test" onclick="runTests()">🧪 Run Tests</button>
            <button class="btn btn-clear" onclick="clearResults()">🗑️ Clear</button>
        </div>

        <div id="testResults"></div>
    </div>

    <script>
        let appWindow = null;
        const tests = [
            { name: 'Script Loading', test: () => ({ passed: true, message: 'OK' }) },
            { name: 'App Window', test: () => ({ passed: !!appWindow && !appWindow.closed, message: appWindow && !appWindow.closed ? 'App window open' : 'App window not open' }) },
            { name: 'LocalStorage', test: () => ({ passed: !!localStorage, message: 'Storage available' }) },
            { name: 'Performance', test: () => ({ passed: !!performance, message: 'Performance API available' }) },
            { name: 'RequestAnimationFrame', test: () => ({ passed: !!requestAnimationFrame, message: 'Animation support available' }) },
            { name: 'DOM Ready', test: () => ({ passed: document.readyState === 'complete', message: 'DOM fully loaded' }) }
        ];

        function openApp() {
            appWindow = window.open('index.html', 'productiveCloud', 'width=1200,height=800');
            if (appWindow) {
                alert('✅ Productive Cloud opened! Wait for it to load, then come back and run tests.');
            } else {
                alert('❌ Failed to open app. Please allow popups and try again.');
            }
        }

        function runTests() {
            if (!appWindow || appWindow.closed) {
                alert('❌ Please open Productive Cloud first using the "Open Productive Cloud" button!');
                return;
            }

            const container = document.getElementById('testResults');
            container.innerHTML = '<h3>🧪 Test Results:</h3>';

            tests.forEach((test, index) => {
                setTimeout(() => {
                    try {
                        const result = test.test();
                        const div = document.createElement('div');
                        div.className = 'test-item';
                        div.innerHTML = `
                            <span>${test.name}</span>
                            <span class="result-${result.passed ? 'pass' : 'fail'}">${result.passed ? 'Pass' : 'Fail'}</span>
                        `;
                        container.appendChild(div);
                    } catch (error) {
                        const div = document.createElement('div');
                        div.className = 'test-item';
                        div.innerHTML = `
                            <span>${test.name}</span>
                            <span class="result-fail">Fail</span>
                        `;
                        container.appendChild(div);
                    }
                }, index * 500);
            });
        }

        function clearResults() {
            document.getElementById('testResults').innerHTML = '';
        }
    </script>
</body>
</html>
